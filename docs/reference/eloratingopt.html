<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create daily ML fitted Elo ranks and multiple derivatives — eloratingopt • EloOptimized</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create daily ML fitted Elo ranks and multiple derivatives — eloratingopt" />
<meta property="og:description" content="Conducts optimized elo rating analyses as per Foerster, Franz et al
  and outputs raw, normalized, cardinal, and  categorical ranks as a list object in 
  R or in an output file. For non-optimized Elo score calculation, use 
  eloratingfixed." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EloOptimized</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/nba-example.html">NBA Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jtfeld/EloOptimized/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create daily ML fitted Elo ranks and multiple derivatives</h1>
    <small class="dont-index">Source: <a href='https://github.com/jtfeld/EloOptimized/blob/master/R/eloratingopt.R'><code>R/eloratingopt.R</code></a></small>
    <div class="hidden name"><code>eloratingopt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Conducts <strong>optimized</strong> elo rating analyses as per Foerster, Franz et al
  and outputs raw, normalized, cardinal, and  categorical ranks as a list object in 
  R or in an output file. For non-optimized Elo score calculation, use 
  <code><a href='eloratingfixed.html'>eloratingfixed</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>eloratingopt</span><span class='op'>(</span><span class='va'>agon_data</span>, <span class='va'>pres_data</span>, fit_init_elo <span class='op'>=</span> <span class='cn'>FALSE</span>, outputfile <span class='op'>=</span> <span class='cn'>NULL</span>, 
  returnR <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>agon_data</th>
      <td><p>Input data frame with dominance interactions, should only contain Date, 
Winner, Loser.  Date should be formatted as MONTH/DAY/YEAR, or already as Date class.</p></td>
    </tr>
    <tr>
      <th>pres_data</th>
      <td><p>Input data frame with columns "id", "start_date" and "end_date".  Date
columns should be formatted as MONTH/DAY/YEAR, or already as Date class.  If all IDs 
are present the whole time, you can ignore this and a pres_data table will be 
automatically generated.</p></td>
    </tr>
    <tr>
      <th>fit_init_elo</th>
      <td><p>If FALSE (the default), fits only the K parameter, with a default 
starting Elo score of 1000 for each individual.  If TRUE, fits K and starting Elo for 
each individual.  The latter option is <em>much</em> slower.</p></td>
    </tr>
    <tr>
      <th>outputfile</th>
      <td><p>Name of csv file to save ranks to.  Default is NULL, in which case 
the function will only return a table in R.  If you supply an output file name
the function will save the results as a csv file in your working directory.</p></td>
    </tr>
    <tr>
      <th>returnR</th>
      <td><p>whether to return an R object from the function call.  Default is TRUE</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list with five or six elements (depending on input):</p><ul>
<li><p><strong>elo</strong> Data frame with all IDs and dates they were present, with the following columns:</p><ul>
<li><p>Date: Dates of study period</p></li>
<li><p>Individual: the names of each ranked individual, for each date they were present</p></li>
<li><p>Elo: fitted Elo scores for each individual on each day</p></li>
<li><p>EloOrdinal: Daily ordinal rank based on Elo scores</p></li>
<li><p>EloScaled: Daily Elo scores rescaled between 0 and 1 according to 
       $$([individual Elo] - min([daily Elo scores])/(max([daily Elo scores]) - min([daily Elo scores]))$$</p></li>
<li><p>ExpNumBeaten: expected number of individuals in the group beaten, which is the sum of 
       winning probabilities based on relative Elo scores of an individual and all others, following 
       equation (4) in Foerster, Franz et al. 2016</p></li>
<li><p>EloCardinal: ExpNumBeaten values rescaled as a percentage of the total number of ranked 
       individuals present in the group on the day of ranking. We encourage the use of this measure.</p></li>
<li><p>JenksEloCardinal: Categorical rank (high, mid, or low) using the Jenks natural breaks 
       classification method implemented in the R package BAMMtools. 
       See <code><a href='https://rdrr.io/pkg/BAMMtools/man/getJenksBreaks.html'>getJenksBreaks</a></code></p></li>
</ul></li>
<li><p><strong>k</strong> The maximum-likelihood fitted k parameter value</p></li>
<li><p><strong>pred_accuracy</strong> Proportion of correctly predicted interactions</p></li>
<li><p><strong>maxLogL</strong> The overall log-likelihood of the observed data given the fitted parameter values 
   based on winning probabilities (as calculated in equation (1) of Foerster, Franz et al 2016) for all 
   interactions</p></li>
<li><p><strong>AIC</strong> Akaike's Information Criterion value as a measure of model fit</p></li>
<li><p><strong>init_elo</strong> (<em>Only returned if you fit initial Elo scores</em>) initial Elo for each individual</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function accepts a data frame of date-stamped dominance interactions and 
  (optionally) a data frame of start and end dates for each individual to be ranked, 
  and outputs daily Elo scores with K parameter, and optionally initial elo scores, fitted using 
  a maximum likelihood approach.  The optimization procedure uses the <code><a href='https://rdrr.io/r/stats/optim.html'>optim()</a></code> function, 
  with a burn in period of 100 interactions.  We use the "Brent" method when fitting only the K 
  parameter, and the "BFGS" method for fitting both K and initial Elo scores.  See 
  <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code> for more details.  Future package development will add additional 
  user control of the optimization procedure, allowing for specification of the burn in period, 
  optimization algorithm, and initial values for optimization.</p>  
<p>Note also that the fitting procedure requires each individual to have at least one win and 
  one loss, so any individual that doesn't meet those criteria is automatically removed.  
  Additionally, any instance of an individual winning against itself is cleaned from the data,
  and several other checks of the data are performed before the optimization procedure is run.</p>  
<p>A detailed description of the function output is given in the <strong>Value</strong> section of 
  this help file:</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>nbadata</span> <span class='op'>=</span> <span class='fu'>EloOptimized</span><span class='fu'>::</span><span class='va'><a href='nba.html'>nba</a></span> <span class='co'>#nba wins and losses from the 1995-96 season</span>
<span class='va'>nbaelo</span> <span class='op'>=</span> <span class='fu'>eloratingopt</span><span class='op'>(</span>agon_data <span class='op'>=</span> <span class='va'>nbadata</span>, fit_init_elo <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; k = 20.315
#&gt; prediction accuracy = 0.663</div><div class='input'><span class='co'># generates optimized elo scores (optimizing only K) and saves them as "nbaelo" </span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joseph Feldblum, Steffen Foerster, Mathias Franz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


